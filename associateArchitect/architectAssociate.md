# AWS Certified Developer Associate - SAA-C02

- Download slides at: https://courses.datacumulus.com/downloads/certified-solutions-architect-pn9/

## IAM & AWS CLI

- Cloud Overview
    - AWS Regions: Cluster of data centers. us-east-1, eu-west-3
    - Availability zones: each region has many availabilty zones. One or more discrete data centers with redundant power, networdking and connectivity. They are seperate from each other, so they are isolated from disasters. They're connected with high bandwidth, ultra-low latency networking. For example: us-east-1a
    - factors for choosing aws regions: government requirements, proximity to customers, available services within a region, pricing
- IAM: identity access management. It is a global service
    - root account created by default, shouldnt be used or shared
    - users are people within your organization, and can be grouped. Usres dont have to be in groups, but can be in multiple groups. They can also have inline policies
        - users or groups can be assigned JSON documents called policies
        - least privilidge principle: dont give more permissions than a user needs
    - IAM Policices Structure
        - consists of version number, id, statement
        - statments consists of sid, effect (allow or deny service), principal(which account it is applied to), action(api calls allowed), resource(list of resources applied to), condition(optional. conditions when statment is applied)
    - Protect IAM Accounts
        - Password policy
        - Multi Factor Authentication (MFA)
    - How users can access AWS
        - options
            - AWS Management console (protected by password + MFA)
            - AWS CLI: protected by access key
            - AWS SDK: for code protected by access keys
        - access keys generated by AWS console. users manage their own access keys
        - access key is username. Secret access key is password
    - **Cloudshell**: browser based shell. Available top right side of nav bar. Not available in all regions
        - All files created in cloudshell exists even after shell restarted
    - IAM Roles: some AWS service will need to perform actions on your behalf. To do so, we will assign permissions to AWS services IAM Roles
        - Common roles: EC2 instance roles, lambda function roles, roles for cloudformation
    - IAM Security Tools
        - IAM Credentials Report (account-level): a report that lists all your account's users and the status of their various credentials
        - IAM Access Advisor (user-level): access advisor shows the service permissions granted to a user and when those services were last accessed. You can use this information to revise your policies

## EC2 Fundamentals

- **EC2 (Elastic Compute Cloud)**: infrastructure as a service
    - Consists of
        - Renting virtual machines (EC2)
        - storing data on virtual drives (EBS)
        - distributing load across machines (ELB)
        - scaling the services using an auto-scaling group (ASG)
    - Config options
        - Operating system: linux, windows, mac os
        - how much compute power and cores (CPU)
        - how much random-access memory (RAM)
        - how much storage space
            - network attached (EBS & EFS)
            - hardware (EC2 Instance store)
        - network card: speed of the card, public IP address
        - firewall rules: security group
        - Bootstrap script (configure at first launch): EC2 user data
- EC2 user data: automate boot tasks. Only run once at the instance first start. EC2 User data script runs as root user so sudo privileges
- EC2 Instance types
    - general purpose: great for a diversity of workloads such as web servers or code repositories. Ex: t2.micro
    - compute optimized: great for compute intensive tasks that require high performance processors such as batch workloads, emdia transcoding, high performance web servers, machine learning, game servers. Ex: C series
    - memory optimized: fast performance for workloads that process large data sets in memory such as high performance relational/non-relation databases, distributed web scale cache store, in-memory databases, applications performing real time processing of big unstructured data. Ex: R series
    - storage optimized: great for storage-intensive tasks that require high, sequential read and write access to large data sets on local storage such as high transaction online transaction processing, data warehousing applications, distributed file systems. Eg: I or D series
    - ex: m5.2xlarge means m (instance class), 5 (generation), 2xlarge(size within the instance class)
- Security groups: control how network traffic is allowed. Fundamental to network security. They are firewall
    - Only contains allow rules. Can reference by IP or by security group
    - Regulate: access to ports, authorized ip ranges, control of inbound/outbound network
    - Good to know
        - can be attached to multiple instances
        - locked down to a region / VPC combination
        - lives outside the EC2. If traffic is blocked the EC2 isntance wont see it
        - good to maintain one seperate security group for SSH access
        - if your application is not accessible (timeout), then its a security group issue. If your application gives a "connection refused" error, then its an application error or its not launched
        - by deafult all inbound traffic is blocked. all outbound traffic is allowed
- Ports to know
    - 22 = SSH (Secure shell) - log into a linux instance
    - 21 = FTP (File Transfer Protocol) - upload files into a file share
    - 22 = SFTP (Secure file transfer protocol) - upload files using SSH
    - 80 = HTTP - access unssecured websites
    - 443 = HTTPS - access secured websites
    - 3389 = RDP (Remote Desktop Protocol) - log into a windows instance
- **Instance connect**: ssh into ec2 instance from browser
- Reminder: IAM Roles can be attached to EC2 instances. This is how we let the EC2 instance interact with AWS services
- EC2 instances purchasing options
    - on demand instances: short workload, predictable pricing
        - highest cost but no upfornt payment. No long term commitment
        - recommended for short term and un-interrupted workloads
    - reserved (1 or 3 years): 75% discount compared to on-demand. Recommended for steady state usage applications
        - reserved instances: long workloads
        - convertible reserved instances: long workloads with flexible instances
            - can change EC2 instance type. 54% discount
        - scheduled reserved instances: launch within time window you reserve
    - spot instances: short workloads, cheap, can lose instances (less reliable)
        - can get upto 90% discount compared to On-demand
        - instances that you can 'lose' at any point of time if your max price is less than the current spot price
        - useful for workloads that are resilient to failure: batch jobs, data analysis, any distributed workloads. Bad for critical jobs
        - steps to terminate spot instances: cancel spot request and then terminate the instances
    - spot block instances: reserve a spot on EC2 instances for a specified duration (1-6 hours) without interruption
    - dedicated hosts: book an entire physical server, control instance placement
        - helps with compliance requirements and reduce costs by allowing you to use your existing server-bound software licenses
        - more expensive. require 3 year reservation period
    - dedicated isntances: instances running on hardware that's dedicated to you. May share hardware with other instances in same account
- **Spot Fleets** = set of spot instances + (optional) on-demand instances. Allows us to automatically request Spot instancs with the lowest price
    - the spot fleet will try to meet the target capacity with price constaints
        - can have multiple launch pools, so that the fleet can choose
        - spot fleet stops launching instaces when reaching capacity or max cost
    - strategies to allocate spot instances
        - lowestPrice: from the pool with the lowest price (cost optimization, short workload)
        - diversified: distributed across all pools (great for availalbility, long workloads)
        - capacityOptimized: pool with the optimal capacity for the number of instances
- IPv4 most common format used online. IPv6 is newer and solves problems for IoT
- Private vs Public vs Elastic IP
    - Public IP: accessible over the internet. Unique to WWW
    - Private IP: accessible to devices in private network. Two different private networks (two companies) can have the same IPs. Machines connect to WWW using a NAT + internet gateway (proxy)
    - Elastic IPs: fixed public IP for instance, and can be attached to one instance at a time. It is a public IPv4 as long as its not deleted. Try to avoid Elastic IPs as it reflects poor architectural decisions
- **Placement Groups**: want control over the EC2 Instance placement strategy
    - Strategy
        - Cluster: clusters instances into a low latency group in a single AZ
            - Pros: great network
            - Cons: if the rack fails, all instances fails at the same time
            - Use case: big data job, low latency and high throughput apps
        - Spread: spreads instances across underlying hardware (max 7 instances per group per AZ). Used for critical applications
            - Pros: span across multiple AZ. Reduced risk is simultaneous failure. EC2 instances are on different physical hardware
            - Cons: limited to 7 instances per AZ per placement group
            - Use case: application needs to maximize high availability. Used in critical applications
        - Partition: spreads instances across many different particions (which rely on different sets of racks) within an AZ. Scales to 100s of EC2 instances per group (hadoopm cassandra, kafka)
            - Use cases: big data applications
- **ENI (Elastic Network Interface)**: logical component in a VPC that represent a virtual network card (advanced use cases)
    - ENI attributes
        - Primary private IPv4, one or more secondary IPv4
        - One elastic IP (IPv4) per private
        - one pylbic IPv4
        - one or more security groups
        - a mac address
    - bound to specific AZ. ENI can be created independently and attech them on the fly on EC2 instances failover
- EC2 Hibernate: in-memory (RAM) state is preserved. The instance boot is much faster. Under the hood the RAM state is written to a file in the root EBS volume. The root EBS volume must be entrypted. Instance cannot be hibernated for more than 60 days. Use cases: long-running processing, saving RAM state, services take a while to initilize
    - stop: the data on disk (EBS) is kept intace in the next start
    - terminate: any EBS volumes (root) also set-up to be destroyed is lost
- EC2 Nitro: underlying platform for the next generation of EC2 instances
    - allows better performance:
        - better networking options
        - higher speed DBS
    - better underlying security
- vCPU
    - multiple threads can run on one CPU (multithreading)
    - each thread is represented as a virtual CPU (vCPU)
    - ex: m5.2xlarge has 4 cup and 2 threads per CPU. Therefore 8 vCPU
- Capacity Reservations: ensure you have EC2 Capacity when needed
    - manual or planned end-date for the reservation
    - no need for 1 or 3 year commitment
    - capacity access is immediate, you get billed as soon as it starts
    - can be combined with reserved instances and savings plans to do cost savings
- Elastic Block Store (EBS) Volume: network drive you can attach to your instances while they run
    - allows instances to persist data, even after termination
    - can be mounted on one instance at a time and bound to specific AZ. An instance can have multi EBS
    - have provisoned capacity (size in GB, IOPs)
    - delete on termincation attribute contols the behavious when ec2 instance terminates. Use case: preserve root volume when instance is terminated
    - think of it as a 'network usb stick'
    - EBS snapshots: make a backup of EBS volume at a point in time. Can copy snapshots across AZ or Region
    - Volume types
        - gp2/gp3 (SSD): general perfomance SSD. cost effective, low latency. Can be usedfor system boot volumes
        - io1/io2: highest performance SSD
        - st1 (HDD)
        - sc1 (HDD): lowest cost HDD
        - provisoned IOPS (SSD): critical business applications with sustained IOPS performance
- Instnace Store: high performance hardware disk. Physical connection
    - EBS volumes are network drives with good but limited performance
    - Instance sstore has high I/O performance. They will lose their strage if they're stopped. It is good for buffer/cache. Risk of data loss if hardware fails. Backsups and replication are users responsibility
- Amazon Machine Image (AMI): customization of an EC2 instance
    - add own software, configuration, operating system etc
    - faster boot/configuration time because all your software is pre-packaged
    - AMI are built for a specific region but can be copied across regions
    - launch EC2 instance from:
        - public ami: aws provided
        - own ami: make and maintain yourself
        - aws marketplace ami: an ami someone else made (and potentially sells)